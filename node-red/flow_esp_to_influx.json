[{"id":"79da4637.7dbd78","type":"function","z":"27a93be2.f2d204","name":"map_to_influx","func":"// parse topic for device + metric nature\n// topic : esp/+/status/# with deviceid then metric\n// payload : the value\n\nvar regex = /[^\\/]+\\/([^\\/]+)\\/status\\/([^\\/]+)/;\nvar matches = msg.topic.match(regex);\n\n// build new payload\nvar tag={};\ntag.device=matches[1];\nvar field={};\nfield[matches[2]]=msg.payload;\n\nmsg.matches=matches;\nmsg.original_payload=msg.payload;\nmsg.payload=[field, tag];\nreturn msg;","outputs":1,"noerr":0,"x":400,"y":180,"wires":[["3ce6b3a0.23338c","3946e32c.37b5cc"]]}]